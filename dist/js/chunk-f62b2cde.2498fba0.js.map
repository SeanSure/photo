{"version":3,"sources":["webpack:///./src/components/test/test.vue?2d83","webpack:///./src/components/test/test.vue?3103","webpack:///./src/components/test/photo.js","webpack:///src/components/test/test.vue","webpack:///./src/components/test/test.vue?4f25","webpack:///./src/components/test/test.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticRenderFns","viewer","container","event","bkPicture","document","querySelector","containerWidth","offsetWidth","containerHeight","offsetHeight","window","addEventListener","onWindowResize","bind","init","clock","THREE","animate","requestAnimationFrame","renderer","scene","camera","dir","speed","angle","getDelta","model","Math","PI","rotateY","console","log","background","load","add","light","position","set","startX","moveEndX","X","rendererPar","precision","antialias","logarithmicDepthBuffer","depth","preserveDrawingBuffer","setSize","setPixelRatio","devicePixelRatio","appendChild","domElement","name","rotation","y","textureLoader","e","preventDefault","touches","pageX","changedTouches","absX","abs","aspect","updateProjectionMatrix","img","theta","index","geometry","texture","material","color","side","map","transparent","plane","setFromCylindricalCoords","lookAt","emit","tTotal","pictures","length","forEach","p","degToRad","createPlane","data","progress","methods","initScene","createPhotos","mounted","beforeDestroy","component"],"mappings":"kHAAA,W,2CCAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,eAClHC,EAAkB,G,oECChBC,E,WACF,WAAYC,EAAWC,EAAOC,GAAW,kCACrCV,KAAKQ,UAAYG,SAASC,cAAcJ,GACxCR,KAAKa,eAAiBb,KAAKQ,UAAUM,YACrCd,KAAKe,gBAAkBf,KAAKQ,UAAUQ,aACtCC,OAAOC,iBAAiB,SAAUlB,KAAKmB,eAAeC,KAAKpB,OAAO,GAClEA,KAAKS,MAAQA,EACbT,KAAKU,UAAYA,EACjBV,KAAKqB,OACL,IAAMC,EAAQ,IAAIC,OACZC,EAAU,SAAVA,IAGF,GAFAC,sBAAsBD,GACtB,EAAKE,SAAS5B,OAAO,EAAK6B,MAAO,EAAKC,QAClC,EAAKC,KAAO,EAAKC,MAAO,CACxB,IAAMC,EAAQT,EAAMU,WAAa,EAAKH,IAAM,EAAKC,MACjD,EAAKG,MAAMF,OAASA,EAEhB,EAAKE,MAAMF,MAAQ,EAAIG,KAAKC,GAAK,EAAI,EACrC,EAAKF,MAAMF,MAAQ,EAAIG,KAAKC,GAAK,EAAI,EAC9B,EAAKF,MAAMF,OAAS,EAC3B,EAAKE,MAAMF,MAAQ,EAEnB,EAAKE,MAAMG,QAAQL,KAI/BP,I,sDAGG,WACHxB,KAAK2B,MAAQ,IAAIJ,OAEjBc,QAAQC,IAAI,YAAYtC,KAAKU,WAC7BV,KAAK2B,MAAMY,YAAa,IAAIhB,QAAsBiB,KAAKxC,KAAKU,WAC5DV,KAAK2B,MAAMc,IAAI,IAAIlB,OAAmB,SAAU,IAChD,IAAMmB,EAAQ,IAAInB,OAAiB,SAAU,IAAK,IAClDmB,EAAMC,SAASC,KAAK,IAAK,EAAG,GAC5B5C,KAAK2B,MAAMc,IAAIC,GAEf1C,KAAK4B,OAAS,IAAIL,OAAwB,GAAIvB,KAAKa,eAAiBb,KAAKe,gBAAiB,GAAK,KAC/Ff,KAAK4B,OAAOe,SAASC,KAAK,IAAK,EAAG,IAElC,IAsBIC,EAAQC,EAAUC,EAtBhBC,EAAc,CAChBC,UAAW,QACXC,WAAW,EACXC,wBAAwB,EACxBC,OAAO,EACPC,uBAAuB,GAG3BrD,KAAK0B,SAAW,IAAIH,OAAoByB,GACxChD,KAAK0B,SAAS4B,QAAQtD,KAAKa,eAAgBb,KAAKe,iBAChDf,KAAK0B,SAAS6B,cAActC,OAAOuC,kBAEnCxD,KAAKQ,UAAUiD,YAAYzD,KAAK0B,SAASgC,YAGzC1D,KAAKiC,MAAQ,IAAIV,OACjBvB,KAAKiC,MAAM0B,KAAO,QAClB3D,KAAKiC,MAAMF,MAAQ,EACnB/B,KAAKiC,MAAM2B,SAASC,GAAK3B,KAAKC,GAAK,EACnCnC,KAAK2B,MAAMc,IAAIzC,KAAKiC,OAEpBjC,KAAK8D,cAAgB,IAAIvC,OAGzBvB,KAAKQ,UAAUU,iBAAiB,cAAc,SAAC6C,GAE3CA,EAAEC,iBAEFnB,EAASkB,EAAEE,QAAQ,GAAGC,SAI1BlE,KAAKQ,UAAUU,iBAAiB,aAAa,SAAC6C,GAE1CA,EAAEC,iBAEFlB,EAAWiB,EAAEI,eAAe,GAAGD,MAG/BnB,EAAID,EAAWD,EAGf,IAAMuB,EAAOlC,KAAKmC,IAAItB,GAClBA,EAAI,GACJ,EAAKlB,IAAM,EACX,EAAKC,MAAQsC,GAAQ,GAAK,GAAaA,EAAO,GAAd,IAEzBrB,EAAI,IACX,EAAKlB,KAAO,EACZ,EAAKC,MAAQsC,GAAQ,GAAK,GAAaA,EAAO,GAAd,S,uCASxCpE,KAAKa,eAAiBb,KAAKQ,UAAUM,YACrCd,KAAKe,gBAAkBf,KAAKQ,UAAUQ,aAEtChB,KAAK4B,OAAO0C,OAAStE,KAAKa,eAAiBb,KAAKe,gBAEhDf,KAAK4B,OAAO2C,yBACZvE,KAAK0B,SAAS4B,QAAQtD,KAAKa,eAAgBb,KAAKe,mB,kCAGxCyD,EAAKC,EAAOC,GAAO,WACrBC,EAAW,IAAIpD,OAA0B,EAAG,EAAG,IACrDvB,KAAK8D,cAActB,KAAKgC,GAAK,SAAAI,GAGzB,IAAMC,EAAW,IAAItD,OAA2B,CAAEuD,MAAO,SAAUC,KAAMxD,OAAiByD,IAAKJ,EAASK,aAAa,IAE/GC,EAAQ,IAAI3D,OAAWoD,EAAUE,GAEvCK,EAAMvC,SAASwC,yBAAyB,KAAMV,EAAO,GACrDS,EAAME,OAAO,IAAI7D,QACjB2D,EAAM9C,SAASF,KAAKC,GAAK,GACzB,EAAKF,MAAMQ,IAAIyC,GACf,EAAKzE,MAAM4E,KAAK,YAAaX,EAAQ,GAAK,EAAKY,a,mCAK1CC,GAAU,WACnBvF,KAAKsF,OAASC,EAASC,OACvBD,EAASE,SAAQ,SAACC,EAAGhB,GACjB,IAAM3C,EAAe2C,EAAQ,EAAKY,OAApB,IACVb,EAAQlD,OAAWoE,SAAS5D,GAChC,EAAK6D,YAAYF,EAAGjB,EAAOC,U,KAQxBnE,ICzIf,yBACA,QAEA,GACEoD,KAAM,SACNkC,KAFF,WAGI,MAAO,CACLC,SAAU,GACVpF,UAAW,iBACX6E,SAAU,CAChB,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,kBACA,qBAIEQ,QAAS,CACPC,UAAW,WAAf,WACMhG,KAAKO,OAAS,IAAI,EAAxB,+BACMP,KAAKO,OAAO0F,aAAajG,KAAKuF,UAC9B,EAAN,2BACQ,EAAR,2BACQlD,QAAQC,IAAI,EAApB,eAIE4D,QA/CF,WAgDIlG,KAAKgG,aAEPG,cAlDF,cCR6V,I,wBCQzVC,EAAY,eACd,EACAtG,EACAQ,GACA,EACA,KACA,KACA,MAIa,aAAA8F,E","file":"js/chunk-f62b2cde.2498fba0.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./test.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import * as THREE from 'three';\r\n// import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\r\nclass viewer {\r\n    constructor(container, event, bkPicture) {\r\n        this.container = document.querySelector(container);//容器\r\n        this.containerWidth = this.container.offsetWidth;\r\n        this.containerHeight = this.container.offsetHeight;\r\n        window.addEventListener('resize', this.onWindowResize.bind(this), false);\r\n        this.event = event;\r\n        this.bkPicture = bkPicture;\r\n        this.init();\r\n        const clock = new THREE.Clock();\r\n        const animate = () => {\r\n            requestAnimationFrame(animate);\r\n            this.renderer.render(this.scene, this.camera);\r\n            if (this.dir && this.speed) {\r\n                const angle = clock.getDelta() * this.dir * this.speed;\r\n                this.model.angle += angle;\r\n\r\n                if (this.model.angle > 2 * Math.PI * 3 / 4) {\r\n                    this.model.angle = 2 * Math.PI * 3 / 4;\r\n                } else if (this.model.angle <= 0) {\r\n                    this.model.angle = 0;\r\n                } else {\r\n                    this.model.rotateY(angle);\r\n                }\r\n            }\r\n        }\r\n        animate();\r\n    }\r\n\r\n    init() {\r\n        this.scene = new THREE.Scene();\r\n\r\n        console.log(13123223213,this.bkPicture);\r\n        this.scene.background = new THREE.TextureLoader().load(this.bkPicture);\r\n        this.scene.add(new THREE.AmbientLight(0xFFFFFF, 1));//添加环境光\r\n        const light = new THREE.PointLight(0xFFD700, 1.3, 20);\r\n        light.position.set(-3.5, 0, 0);\r\n        this.scene.add(light);\r\n\r\n        this.camera = new THREE.PerspectiveCamera(30, this.containerWidth / this.containerHeight, 0.1, 1000.00);//相机\r\n        this.camera.position.set(-3.5, 0, 20);\r\n        // this.camera.position.set(0, 0, 30);\r\n        const rendererPar = {//渲染器参数设置\r\n            precision: \"highp\",\r\n            antialias: !0,\r\n            logarithmicDepthBuffer: !!0,\r\n            depth: !0,\r\n            preserveDrawingBuffer: !0\r\n        };\r\n\r\n        this.renderer = new THREE.WebGLRenderer(rendererPar);\r\n        this.renderer.setSize(this.containerWidth, this.containerHeight);\r\n        this.renderer.setPixelRatio(window.devicePixelRatio);\r\n\r\n        this.container.appendChild(this.renderer.domElement);\r\n\r\n        // this.controls = new OrbitControls(this.camera, this.renderer.domElement);//控制器引入\r\n        this.model = new THREE.Group();\r\n        this.model.name = 'model';\r\n        this.model.angle = 0;\r\n        this.model.rotation.y = -Math.PI / 2;\r\n        this.scene.add(this.model);\r\n\r\n        this.textureLoader = new THREE.TextureLoader();\r\n        var startX, moveEndX, X;\r\n\r\n        this.container.addEventListener('touchstart', (e) => {\r\n\r\n            e.preventDefault();\r\n\r\n            startX = e.touches[0].pageX;\r\n\r\n        });\r\n\r\n        this.container.addEventListener('touchmove', (e) => {\r\n\r\n            e.preventDefault();\r\n\r\n            moveEndX = e.changedTouches[0].pageX;\r\n\r\n\r\n            X = moveEndX - startX;\r\n\r\n\r\n            const absX = Math.abs(X);\r\n            if (X > 0) {\r\n                this.dir = 1;\r\n                this.speed = absX >= 50 ? 0.6 : 0.6 * (absX / 50);\r\n\r\n            } else if (X < 0) {\r\n                this.dir = -1;\r\n                this.speed = absX >= 50 ? 0.6 : 0.6 * (absX / 50);\r\n            }\r\n\r\n        });\r\n\r\n\r\n    }\r\n\r\n    onWindowResize() {\r\n        this.containerWidth = this.container.offsetWidth;\r\n        this.containerHeight = this.container.offsetHeight;\r\n        // 重新设置相机宽高比例\r\n        this.camera.aspect = this.containerWidth / this.containerHeight;\r\n        // 更新相机投影矩阵\r\n        this.camera.updateProjectionMatrix();\r\n        this.renderer.setSize(this.containerWidth, this.containerHeight);\r\n    }\r\n\r\n    createPlane(img, theta, index) {\r\n        const geometry = new THREE.PlaneBufferGeometry(7, 9, 32);\r\n        this.textureLoader.load(img, texture => {\r\n            // texture.anisotropy = 16;\r\n            // const material = new THREE.MeshBasicMaterial({ color: 0xffffff, side: THREE.DoubleSide, map: texture, transparent: !0 });\r\n            const material = new THREE.MeshStandardMaterial({ color: 0xffffff, side: THREE.FrontSide, map: texture, transparent: !0 });\r\n\r\n            const plane = new THREE.Mesh(geometry, material);\r\n\r\n            plane.position.setFromCylindricalCoords(3.5, -theta, 0);\r\n            plane.lookAt(new THREE.Vector3());\r\n            plane.rotateY(-Math.PI / 2);\r\n            this.model.add(plane);\r\n            this.event.emit(\"progress\", (index + 1) / this.tTotal);\r\n        })\r\n\r\n    }\r\n\r\n    createPhotos(pictures) {\r\n        this.tTotal = pictures.length;\r\n        pictures.forEach((p, index) => {\r\n            const angle = 270 * (index / this.tTotal)\r\n            let theta = THREE.Math.degToRad(angle);\r\n            this.createPlane(p, theta, index);\r\n        })\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default viewer;","<template>\r\n  <div class=\"container\"></div>\r\n</template>\r\n<script>\r\nimport Viewer from \"./photo.js\";\r\nconst EventEmitter = require(\"events\").EventEmitter;\r\nconst event = new EventEmitter();\r\n\r\nexport default {\r\n  name: \"Viewer\",\r\n  data() {\r\n    return {\r\n      progress: \"\",\r\n      bkPicture: \"/photos/bg.png\",\r\n      pictures: [\r\n        \"/photos/p01.png\",\r\n        \"/photos/p02.png\",\r\n        \"/photos/p03.png\",\r\n        \"/photos/p04.png\",\r\n        \"/photos/p05.png\",\r\n        \"/photos/p06.png\",\r\n        \"/photos/p07.png\",\r\n        \"/photos/p08.png\",\r\n        \"/photos/p09.png\",\r\n        \"/photos/p10.png\",\r\n        \"/photos/p11.png\",\r\n        \"/photos/p12.png\",\r\n        \"/photos/p13.png\",\r\n        \"/photos/p14.png\",\r\n        \"/photos/p15.png\",\r\n        \"/photos/p16.png\",\r\n        \"/photos/p17.png\",\r\n        \"/photos/p18.png\",\r\n        \"/photos/p19.png\",\r\n        \"/photos/p20.png\",\r\n        \"/photos/p21.png\",\r\n        \"/photos/p22.png\",\r\n        \"/photos/p23.png\",\r\n        \"/photos/p24.png\",\r\n        \"/photos/p25.png\",\r\n        \"/photos/p26.png\",\r\n        \"/photos/p27.png\",\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    initScene: function () {\r\n      this.viewer = new Viewer(\".container\", event, this.bkPicture);\r\n      this.viewer.createPhotos(this.pictures);\r\n      event.on(\"progress\", (v) => {\r\n        this.progress = Math.round(v * 100);\r\n        console.log(this.progress);\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    this.initScene();\r\n  },\r\n  beforeDestroy() {},\r\n};\r\n</script>\r\n<style>\r\n.container {\r\n  height: 100%;\r\n  width: 100%;\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./test.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./test.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./test.vue?vue&type=template&id=96de5842&\"\nimport script from \"./test.vue?vue&type=script&lang=js&\"\nexport * from \"./test.vue?vue&type=script&lang=js&\"\nimport style0 from \"./test.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}